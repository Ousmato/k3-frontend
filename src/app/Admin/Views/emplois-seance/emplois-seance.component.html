<main>

  <div (click)="goBack()" class="back-button">
    <fa-icon [icon]="icons.back"></fa-icon>
  </div>
  <div class="position-realive">
    <app-configure-seance *ngIf="is_show_configure" [idEmplois]="idUrl" (closeModal)="to_configure()" [configSeance]="configSeance"></app-configure-seance>
  
  </div>
    <section class="section-head">
     
        <div class="month-contenaire">
            <p>{{formattedDate}}</p>
            <p> Emploi du temps du {{emplois.dateDebut}} au {{emplois.dateFin}}</p>
            <p>{{emplois.idClasse.idFiliere?.idNiveau?.nom}} ( {{emplois.idClasse.idFiliere?.idFiliere?.nomFiliere}} )</p></div>
              
            
        <div class="btn-contenaire" *ngIf="permission">
            <div class="child-1">
              <button (click)="to_show_button()" class="btn btn-valid-emplois" type="button"><fa-icon [icon]="icons.edit"></fa-icon> Editer</button>
       
              <button  class="btn btn-show-form" type="button" (click)="to_groupe(emplois.idClasse.id!, emplois.id!)"><fa-icon [icon]="icons.user"></fa-icon> Groupe</button>
              <button  class="btn btn-show-form" type="button" (click)="to_configure()"><fa-icon [icon]="icons.list"></fa-icon> Autres</button>
            </div>
           
        </div>

    </section>
    <section class="content">
     
        <!-- ------------------------------------------------------ -->
         <div id="idTable" class="section-table">
          <table class="table table-bordered" id="table">
            <thead>
              <tr>
                <th class="horai">Horaires</th>
                <!-- En-tête des jours -->
                <ng-container *ngFor="let dateInfo of day_of_head">
                  <th scope="col">{{ dateInfo }}</th>
                </ng-container>
              </tr>
            </thead>
            <tbody *ngIf="seances.length; else notFound">
              <!-- Iterer sur les créneaux horaires -->
              <ng-container *ngFor="let timeSlot of palageHoraire">
                <tr *ngIf="timeSlot !== '12:00 - 14:00' && timeSlot !== '10:00 - 10:15'">
                  <th scope="row" class="text-left">
                    <div class="seance-content">
                      <p>{{ timeSlot }}</p>
                    </div>
                  </th>
                  <!-- Iterer sur les jours -->
                  <ng-container *ngFor="let dateInfo of day_of_head">
                    <td scope="col">
                      <!-- Vérifier si une séance correspond au créneau horaire et au jour -->
                      <ng-container *ngFor="let seance of seances">
                        <ng-container *ngIf="dateInfo.toLocaleLowerCase() == getDayFromDate(seance.date?.toString()!)">
                          <div class="seance-content">
                            <div class="childre-1">
                              <strong>{{ seance.idTeacher.nom.charAt(0).toUpperCase() }}. {{ seance.idTeacher.prenom.toUpperCase() }}</strong><br>
                              {{ seance.idModule.nomModule }} <br>
                              <ng-container *ngFor="let item of configSeance">
                                <p *ngIf="dateInfo.toLocaleLowerCase() == getDayFromDateConfig(item.idSeance!.date?.toString()!) && timeSlot == item.plageHoraire && !is_show_button"  >
                                  {{ item.idParticipant!.idStudentGroup.nom}} <br>
                                   <span>{{item.seanceType.toLocaleUpperCase()}}</span>
                                   
                                </p>
                              </ng-container>
                            </div>
                            <div class="childre-2">
                              <div class="btn-cont" *ngIf="is_show_button">
                                <button (click)="show_comfirme_delete(seance.heureDebut, seance.heureFin)" type="button">
                                  <fa-icon [icon]="icons.delete" [ngStyle]="{ color: 'red' }" class="icon"></fa-icon>
                                </button>
                                <button (click)="show_update_seance(seance.id!)">
                                  <fa-icon [icon]="icons.edit" class="icon"></fa-icon>
                                </button>
                              </div>
                            </div>
                          </div>
                        </ng-container>
                      </ng-container>
                    </td>
                  </ng-container>
                </tr>
                <tr *ngIf="timeSlot === '12:00 - 14:00'">
                  <td colspan="9" class="text-center">Pause Midi</td>
                </tr>
                <tr *ngIf="timeSlot === '10:00 - 10:15'">
                  <td colspan="9" class="text-center">Recréation</td>
                </tr>
              </ng-container>
              
             
            </tbody>
            <ng-template #notFound>
              <tr>
                <td colspan="100%">Aucune séance trouvée</td>
              </tr>
            </ng-template>
          </table>
          
           
         
        </div>
        <div class="refresh">
          <span (click)="imprimer()">Imprimer en pdf</span>
        </div>
          
        
    </section>
    
    <!-- --------------------------------------- -->

    <div class="overlay" *ngIf="selected_seance_heure_fin" (click)="preventClick($event)"></div>
    <div class="overlay" *ngIf="is_show_configure"></div>
    <div class="overlay" *ngIf="deleted_modal" (click)="preventClick($event)"></div>

    <div class="views delete-modal" *ngIf="deleted_modal">
      <h4>Confirmation de suppression</h4>
      <div class="content">
        <p>Êtes-vous sûr de vouloir supprimer cet élément ?</p>
      </div>
      <div class="button-cash">
        <a (click)="close_delete_modal()"><span>Annuler</span></a>
        <button class="submit" (click)="deleted(hasDeleted)" ><span>Confirmer</span></button>
      </div>
    </div>
</main>